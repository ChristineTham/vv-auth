---
import Layout from '../layouts/default.astro'

const title = 'Membership'
const description =
  'Join our community to access additional content (and also help keep this site alive!).'
---

<Layout {title} {description}>
  <div class="text-center py-12 px-6 mt-12">
    <h1 class="font-display font-bold text-5xl mb-6">{title}</h1>
    <p class="max-w-lg mx-auto">{description}</p>
  </div>

  <div class="container mx-auto px-6 mb-12 prose prose-sm sm:prose lg:prose-lg">
  </div>
  <section class="py-10 bg-gray-50 sm:py-16 lg:py-24">
    <div class="px-4 mx-auto max-w-7xl sm:px-6 lg:px-8">
      <div class="max-w-2xl mx-auto text-center">
        <h2
          class="text-3xl font-bold leading-tight text-black sm:text-4xl lg:text-5xl">
          Pricing & Plans
        </h2>
        <p
          class="max-w-lg mx-auto mt-4 text-base leading-relaxed text-gray-600">
          Currently we offer both a free membership subscription plus an
          additional premium monthly plan.
        </p>
      </div>

      <div
        class="grid max-w-3xl grid-cols-1 gap-6 mx-auto mt-8 sm:mt-16 sm:grid-cols-2">
        <div class="bg-white border-4 border-transparent rounded-md">
          <div class="p-6 md:py-10 md:px-9">
            <div class="inline-block px-4 py-2 bg-gray-100 rounded-full">
              <h3 class="text-sm font-semibold text-gray-900">Member</h3>
            </div>
            <p class="mt-5 text-5xl font-bold text-black">Free</p>
            <p class="mt-2 text-base text-gray-600">Forever!</p>

            <ul class="flex flex-col mt-8 space-y-4">
              <li class="inline-flex items-center space-x-2">
                <svg
                  class="flex-shrink-0 w-5 h-5 text-green-500"
                  xmlns="http://www.w3.org/2000/svg"
                  viewBox="0 0 20 20"
                  fill="currentColor">
                  <path
                    fill-rule="evenodd"
                    d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z"
                    clip-rule="evenodd"></path>
                </svg>
                <span class="text-base font-medium text-gray-900"
                  >Access all free content</span
                >
              </li>

              <li class="inline-flex items-center space-x-2">
                <svg
                  class="flex-shrink-0 w-5 h-5 text-green-500"
                  xmlns="http://www.w3.org/2000/svg"
                  viewBox="0 0 20 20"
                  fill="currentColor">
                  <path
                    fill-rule="evenodd"
                    d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z"
                    clip-rule="evenodd"></path>
                </svg>
                <span class="text-base font-medium text-gray-900"
                  >Receive email updates</span
                >
              </li>

              <li class="inline-flex items-center space-x-2">
                <svg
                  class="flex-shrink-0 w-5 h-5 text-green-500"
                  xmlns="http://www.w3.org/2000/svg"
                  viewBox="0 0 20 20"
                  fill="currentColor">
                  <path
                    fill-rule="evenodd"
                    d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z"
                    clip-rule="evenodd"></path>
                </svg>
                <span class="text-base font-medium text-gray-400"
                  >Access premium content</span
                >
              </li>

              <li class="inline-flex items-center space-x-2">
                <svg
                  class="flex-shrink-0 w-5 h-5 text-green-500"
                  xmlns="http://www.w3.org/2000/svg"
                  viewBox="0 0 20 20"
                  fill="currentColor">
                  <path
                    fill-rule="evenodd"
                    d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z"
                    clip-rule="evenodd"></path>
                </svg>
                <span class="text-base font-medium text-gray-400"
                  >Discounts on products and events (future)</span
                >
              </li>
            </ul>

            <button
              id="signup"
              class="inline-flex items-center justify-center w-full px-4 py-4 mt-8 font-semibold text-white transition-all duration-200 bg-gray-800 rounded-md hover:bg-gray-600 focus:bg-gray-600">
              Sign up</button
            >

            <p class="mt-5 text-sm text-gray-500">No Credit Card Required</p>
          </div>
        </div>

        <div class="bg-white border-4 border-blue-600 rounded-md">
          <div class="p-6 md:py-10 md:px-9">
            <div class="inline-block px-4 py-2 bg-blue-100 rounded-full">
              <h3 class="text-sm font-semibold text-blue-600">Premium</h3>
            </div>
            <p class="mt-5 text-5xl font-bold text-black">$5</p>
            <p class="mt-2 text-base text-gray-600">Per month</p>

            <ul class="flex flex-col mt-8 space-y-4">
              <li class="inline-flex items-center space-x-2">
                <svg
                  class="flex-shrink-0 w-5 h-5 text-green-500"
                  xmlns="http://www.w3.org/2000/svg"
                  viewBox="0 0 20 20"
                  fill="currentColor">
                  <path
                    fill-rule="evenodd"
                    d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z"
                    clip-rule="evenodd"></path>
                </svg>
                <span class="text-base font-medium text-gray-900"
                  >Access all free content</span
                >
              </li>

              <li class="inline-flex items-center space-x-2">
                <svg
                  class="flex-shrink-0 w-5 h-5 text-green-500"
                  xmlns="http://www.w3.org/2000/svg"
                  viewBox="0 0 20 20"
                  fill="currentColor">
                  <path
                    fill-rule="evenodd"
                    d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z"
                    clip-rule="evenodd"></path>
                </svg>
                <span class="text-base font-medium text-gray-900"
                  >Receive email updates</span
                >
              </li>

              <li class="inline-flex items-center space-x-2">
                <svg
                  class="flex-shrink-0 w-5 h-5 text-green-500"
                  xmlns="http://www.w3.org/2000/svg"
                  viewBox="0 0 20 20"
                  fill="currentColor">
                  <path
                    fill-rule="evenodd"
                    d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z"
                    clip-rule="evenodd"></path>
                </svg>
                <span class="text-base font-medium text-gray-900"
                  >Access premium content</span
                >
              </li>

              <li class="inline-flex items-center space-x-2">
                <svg
                  class="flex-shrink-0 w-5 h-5 text-green-500"
                  xmlns="http://www.w3.org/2000/svg"
                  viewBox="0 0 20 20"
                  fill="currentColor">
                  <path
                    fill-rule="evenodd"
                    d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z"
                    clip-rule="evenodd"></path>
                </svg>
                <span class="text-base font-medium text-gray-900"
                  >Discounts on products and events (future)</span
                >
              </li>
            </ul>

            <button
              id="join"
              class="inline-flex items-center justify-center w-full px-4 py-4 mt-8 font-semibold text-white transition-all duration-200 rounded-md bg-gradient-to-r from-fuchsia-600 to-blue-600 hover:opacity-80 focus:opacity-80">
              Join
            </button>

            <p class="mt-5 text-sm text-gray-500">Credit Card Required</p>
          </div>
        </div>
      </div>
    </div>
  </section>
  <script is:inline>
    const button1 = document.getElementById('signup')
    const button2 = document.getElementById('join')

    const login = () => netlifyIdentity.open('login')
    const signup = () => netlifyIdentity.open('signup')

    // by default, add login and signup functionality
    button1.addEventListener('click', signup)
    button2.addEventListener('click', login)

    const updateUserInfo = (user) => {
      const container = document.querySelector('.user-info')

      // cloning the buttons removes existing event listeners
      const b1 = button1.cloneNode(true)
      const b2 = button2.cloneNode(true)

      // empty the user info div
      container.innerHTML = ''

      if (user) {
        b1.innerText = 'Log Out'
        b1.addEventListener('click', () => {
          netlifyIdentity.logout()
        })

        b2.innerText = 'Manage Subscription'
        b2.addEventListener('click', () => {
          // TODO handle subscription management
        })
      } else {
        // if no one is logged in, show login/signup options
        b1.innerText = 'Log In'
        b1.addEventListener('click', login)

        b2.innerText = 'Sign Up'
        b2.addEventListener('click', signup)
      }

      // add the updated buttons back to the user info div
      container.appendChild(b1)
      container.appendChild(b2)
    }

    const handleUserStateChange = (user) => {
      updateUserInfo(user)
    }

    netlifyIdentity.on('init', handleUserStateChange)
    netlifyIdentity.on('login', handleUserStateChange)
    netlifyIdentity.on('logout', handleUserStateChange)
  </script>
</Layout>
