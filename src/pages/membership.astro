---
import Layout from '../layouts/default.astro'

const title = 'Membership'
const description =
  'Join our community to access additional content (and also help keep this site alive!).'
---

<Layout {title} {description}>
  <div class="text-center py-12 px-6 mt-12">
    <h1 class="font-display font-bold text-5xl mb-6">{title}</h1>
    <p class="max-w-lg mx-auto">{description}</p>
  </div>

  <div class="container mx-auto px-6 mb-12 prose prose-sm sm:prose lg:prose-lg">
  </div>
  <section class="py-10 bg-gray-50 sm:py-16 lg:py-24">
    <div class="px-4 mx-auto max-w-7xl sm:px-6 lg:px-8">
      <div class="max-w-2xl mx-auto text-center">
        <h2
          class="text-3xl font-bold leading-tight text-black sm:text-4xl lg:text-5xl">
          Pricing & Plans
        </h2>
        <p
          class="max-w-lg mx-auto mt-4 text-base leading-relaxed text-gray-600">
          Currently we offer both a free membership subscription plus an
          additional premium monthly plan.
        </p>
      </div>

      <div
        class="grid max-w-3xl grid-cols-1 gap-6 mx-auto mt-8 sm:mt-16 sm:grid-cols-2">
        <div class="bg-white border-4 border-transparent rounded-md">
          <div class="p-6 md:py-10 md:px-9">
            <div class="inline-block px-4 py-2 bg-gray-100 rounded-full">
              <h3 class="text-sm font-semibold text-gray-900">Member</h3>
            </div>
            <p class="mt-5 text-5xl font-bold text-black">Free</p>
            <p class="mt-2 text-base text-gray-600">Forever!</p>

            <ul class="flex flex-col mt-8 space-y-4">
              <li class="inline-flex items-center space-x-2">
                <span class="flex-shrink-0 w-5 h-5 text-green-500 i-fa6-regular-square-plus"/>
                <span class="text-base font-medium text-gray-900"
                  >Access all free content</span
                >
              </li>

              <li class="inline-flex items-center space-x-2">
                <span class="flex-shrink-0 w-5 h-5 text-green-500 i-fa6-regular-square-plus"/>
                <span class="text-base font-medium text-gray-900"
                  >Access member exclusive content</span
                >
              </li>

              <li class="inline-flex items-center space-x-2">
                <span class="flex-shrink-0 w-5 h-5 text-red-500 i-fa6-regular-square-minus"/>
                <span class="text-base font-medium text-gray-400"
                  >Access premium content</span
                >
              </li>

              <li class="inline-flex items-center space-x-2">
                <span class="flex-shrink-0 w-5 h-5 text-red-500 i-fa6-regular-square-minus"/>
                <span class="text-base font-medium text-gray-400"
                  >Discount on events and workshops</span
                >
              </li>
            </ul>

            <button
              id="member"
              class="inline-flex items-center justify-center w-full px-4 py-4 mt-8 font-semibold text-white transition-all duration-200 bg-gray-800 rounded-md hover:bg-gray-600 focus:bg-gray-600">
              Sign up</button
            >

            <p class="mt-5 text-sm text-gray-500">No Credit Card Required</p>
          </div>
        </div>

        <div class="bg-white border-4 border-blue-600 rounded-md">
          <div class="p-6 md:py-10 md:px-9">
            <div class="inline-block px-4 py-2 bg-blue-100 rounded-full">
              <h3 class="text-sm font-semibold text-blue-600">Premium</h3>
            </div>
            <p class="mt-5 text-5xl font-bold text-black">$5</p>
            <p class="mt-2 text-base text-gray-600">Per month</p>

            <ul class="flex flex-col mt-8 space-y-4">
              <li class="inline-flex items-center space-x-2">
                <span class="flex-shrink-0 w-5 h-5 text-green-500 i-fa6-regular-square-plus"/>
                <span class="text-base font-medium text-gray-900"
                  >Access all free content</span
                >
              </li>

              <li class="inline-flex items-center space-x-2">
                <span class="flex-shrink-0 w-5 h-5 text-green-500 i-fa6-regular-square-plus"/>
                <span class="text-base font-medium text-gray-900"
                  >Access member exclusive content</span
                >
              </li>

              <li class="inline-flex items-center space-x-2">
                <span class="flex-shrink-0 w-5 h-5 text-green-500 i-fa6-regular-square-plus"/>
                <span class="text-base font-medium text-gray-900"
                  >Access premium content</span
                >
              </li>

              <li class="inline-flex items-center space-x-2">
                <span class="flex-shrink-0 w-5 h-5 text-green-500 i-fa6-regular-square-plus"/>
                <span class="text-base font-medium text-gray-900"
                  >20% Discount on events and workshops</span
                >
              </li>
            </ul>

            <button
              id="premium"
              class="inline-flex items-center justify-center w-full px-4 py-4 mt-8 font-semibold text-white transition-all duration-200 rounded-md bg-gradient-to-r from-fuchsia-600 to-blue-600 hover:opacity-80 focus:opacity-80">
              Join
            </button>

            <p class="mt-5 text-sm text-gray-500">Credit Card Required</p>
          </div>
        </div>
      </div>
    </div>
  </section>
  <script is:inline>
    document.body.onload = function () {
      const member = document.getElementById('member')
      const premium = document.getElementById('premium')

      if (window.netlifyUser) {
        member.innerText = "Manage"
      } 

      member.addEventListener('click', () => {
        if (!window.netlifyUser) {
          netlifyIdentity.open('signup')
        } else {
          fetch('/api/create-manage-link', {
            method: 'POST',
            headers: {
              Authorization: `Bearer ${window.netlifyUser.token.access_token}`
            },
            body: JSON.stringify(window.netlifyUser)
          })
            .then((res) => res.json())
            .then((link) => {
              window.location.href = link
            })
            .catch((err) => console.error(err))
        }
      })
      premium.addEventListener('click', () => {
        if (!window.netlifyUser) {
          netlifyIdentity.open('login')
        } else {
          fetch('/api/create-premium', {
            method: 'POST',
            headers: {
              Authorization: `Bearer ${window.netlifyUser.token.access_token}`
            },
            body: JSON.stringify(window.netlifyUser)
          })
            .then((res) => res.json())
            .then((session) => {
              window.location.href = session.url
            })
            .catch((err) => console.error(err))
        }
      })
    }
  </script>
  <!-- <div class="container mx-auto px-6 mb-12 prose prose-sm sm:prose lg:prose-lg">
    <script async src="https://js.stripe.com/v3/pricing-table.js"></script>
    <stripe-pricing-table pricing-table-id="prctbl_1N7rMcEWbgx7oJNLEoT6tMc9"
    publishable-key="pk_test_51HOdsUEWbgx7oJNLbIIkd9HlrkiUvVkRgF1JOAGu8B5pazboU4bKGEocCRdDffUIoiA6CcNFSIfxdXq37AGX08IA00HZTNNLAH">
    </stripe-pricing-table>
  </div> -->
</Layout>
